Metadata-Version: 2.4
Name: dialogs-sgr
Version: 0.1.0
Summary: Python-only SGR platform for dialog quality with SQLite and tiny CLI
Requires-Python: >=3.11
Description-Content-Type: text/markdown
Requires-Dist: openai>=1.58.0
Requires-Dist: pydantic>=2.9.0
Requires-Dist: Pillow>=10.0.0
Provides-Extra: dev
Requires-Dist: pytest>=8.3.0; extra == "dev"
Requires-Dist: jupyter>=1.1.1; extra == "dev"
Requires-Dist: ipykernel>=6.29.5; extra == "dev"
Requires-Dist: pandas>=2.2.0; extra == "dev"

# dialogs-sgr

SGR-платформа для контроля качества продажных переписок.

Основной бизнес-эффект: рост `retention` за счет стабильного качества ответов продавца в каждом клиентском диалоге.

## Для C-Level за 2 минуты

Что система проверяет в каждой реплике продавца:
- `greeting`: есть ли корректное приветствие;
- `upsell`: предложен ли уместный следующий платный шаг;
- `empathy`: признана ли ситуация клиента перед решением.

Что гарантирует надежность:
- каждая оцениваемая реплика проходит через `evaluator` и `judge`;
- `judge_coverage` в продукте зафиксирован как `1.0`;
- по каждому правилу считаются `evaluator_hit_rate`, `judge_correctness`, `judge_coverage`;
- в БД сохраняется полный аудит LLM-вызовов (`request_json`, `response_json`, `extracted_json`).

## Неподвижный Контракт Исполнения

Сканирование работает в одном фиксированном режиме:
- bundled-оценка: один вызов evaluator и один вызов judge на реплику продавца;
- full context: оценка опирается на полный контекст диалога до текущего шага;
- full judge coverage: judge обязателен для каждой оцениваемой реплики;
- full LLM audit trace: полный payload и ответ сохраняются всегда.

Этот контракт не настраивается пользовательскими флагами scan.

## Точки Входа Документации (Doc-Contract)

После любого продуктового изменения синхронно обновляются:
1. `/Users/ablackman/go/src/github.com/tetraminz/sales_protocol/README.md`
2. `/Users/ablackman/go/src/github.com/tetraminz/sales_protocol/src/dialogs/sgr_core.py`
3. `/Users/ablackman/go/src/github.com/tetraminz/sales_protocol/tests/test_platform_dataset_style.py`
4. `/Users/ablackman/go/src/github.com/tetraminz/sales_protocol/notebooks/sgr_quality_demo.ipynb`
5. `/Users/ablackman/go/src/github.com/tetraminz/sales_protocol/artifacts/metrics.md`
6. `/Users/ablackman/go/src/github.com/tetraminz/sales_protocol/artifacts/accuracy_diff.png`
7. `/Users/ablackman/go/src/github.com/tetraminz/sales_protocol/Makefile`
8. `/Users/ablackman/go/src/github.com/tetraminz/sales_protocol/docs/stability_case_review.md`

## Быстрый Запуск

```bash
make setup
make init-fresh
export OPENAI_API_KEY=...
make scan
make report
make test
```

Открыть executive-ноутбук:

```bash
make notebook
```

Kernel: `Python (dialogs-sgr)`.

## Ключевые Артефакты

- Executive notebook: `/Users/ablackman/go/src/github.com/tetraminz/sales_protocol/notebooks/sgr_quality_demo.ipynb`
- Метрики: `/Users/ablackman/go/src/github.com/tetraminz/sales_protocol/artifacts/metrics.md`
- Heatmap: `/Users/ablackman/go/src/github.com/tetraminz/sales_protocol/artifacts/accuracy_diff.png`

## Глоссарий Метрик

- `evaluator_hit_rate`: доля `eval_hit=1`.
- `judge_correctness`: доля `judge_label=1` среди проверенных judge кейсов.
- `judge_coverage`: доля проверенных judge кейсов среди всех eval-кейсов.

## Ограничения И Интерпретация

- Система целенаправленно зафиксирована на трех правилах: `greeting`, `upsell`, `empathy`.
- Схема v4+ не предназначена для автоматической миграции старых run-данных.
- Полный LLM trace увеличивает объем БД, но нужен для аудита и управляемости на C-level.
